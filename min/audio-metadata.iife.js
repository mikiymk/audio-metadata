var AudioMetadata=function(g){"use strict";const d=t=>t.replace(/\0+$/,""),v=(t,e)=>{const n=t.indexOf(e);return[t.substring(0,n),t.substring(n+1)]},l=t=>{if(t instanceof Uint8Array&&(t=t.buffer.slice(0)),!(t instanceof ArrayBuffer))throw new Error("Expected instance of Buffer or ArrayBuffer");return new DataView(t)},y=(t,e,n)=>new Uint8Array(t.buffer).slice(e,e+n),f=t=>(e,n,r)=>new TextDecoder(t).decode(e.buffer.slice(n,n+r)),s=f("ascii"),b=f(),M=f("utf16be"),L=(t,e)=>{if(t.byteLength<e+27)return;const n=t.getUint8(e+26),r=y(t,e+27,n),i=27+n;if(!r.length)return;const c=i+r.reduce((u,a)=>u+a),o=i+7;return{pageSize:c,packet:l(y(t,e+o,c-o))}},k=t=>{try{const e=t.getUint32(0,!0),n=t.getUint32(4+e,!0),r={},i={tracknumber:"track"};for(let c=0,o=8+e;c<n;c++){const u=t.getUint32(o,!0),a=b(t,o+4,u),[m,h]=v(a,"="),T=m.toLowerCase();r[i[T]||T]=r[T]=d(h),o+=4+u}return r}catch{return}},S=t=>{const e=l(t),n=L(e,0);if(!n)return;const r=L(e,n.pageSize);if(r)return k(r.packet)},A=t=>s(t,t.byteLength-128,3)==="TAG",w=t=>{const e=l(t);try{if(!A(e))return;const n=e.byteLength-128,r=e.getUint8(n+125)===0,i=d(s(e,n+3,30)),c=d(s(e,n+33,30)),o=d(s(e,n+63,30)),u=d(s(e,n+93,4)),a=d(s(e,n+97,r?28:30)),m=r?e.getUint8(n+126):void 0,h=e.getUint8(n+127);return{title:i,artist:c,album:o,year:u,comment:a,track:m,genre:h}}catch{return}},U=(t,e)=>y(t,e,4).reduce((n,r)=>n<<7|r&268435455,0),C=t=>{switch(t){case 1:return(e,n,r)=>e.getUint16(n)===65279?M(e,n,r):f("utf16le")(e,n,r);case 2:return f("utf16be");case 3:return b;case 0:default:return s}},p={TALB:"album",TCOM:"composer",TIT1:"title",TIT2:"title",TPE1:"artist",TRCK:"track",TSSE:"encoder",TDRC:"year",TCON:"genre"},z=(t,e)=>{try{const n=s(t,e,4),r=10+U(t,e+4),i=n[0]==="T"?d(C(t.getUint8(e+9))(t,e+11,r-11)):void 0;return{id:n,size:r,content:i}}catch{return}},E=t=>{const e=l(t);if(s(e,0,3)!=="ID3")return;const n=e.getUint8(5),r=U(e,6),i=!!(n&128),c={},o=i?U(e,10):0;for(let u=10+o;u<10+o+r;){const a=z(e,u);if(!a)break;if(u+=a.size,!a.content)continue;const m=p[a.id]||a.id;if(m==="TXXX"){const[h,T]=v(a.content,"\0");c[h]=T}else c[m]=c[a.id]=a.content}return c},B=t=>s(t,0,4)==="fLaC",I=t=>{const e=l(t);if(!B(e))return;let n=4,r=!1,i={};for(;!r;){const c=e.getUint8(n),o=e.getUint16(n+1)*2**16+e.getUint8(n+3);r=c>127,(c&127)==4&&(i=Object.assign(i,k(l(y(e,n+4,o))))),n+=4+o}return i};return g.flac=I,g.id3v1=w,g.id3v2=E,g.ogg=S,Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),g}({});

var AudioMetadata=function(l){"use strict";const d=t=>t.replace(/\0+$/,""),U=(t,e)=>{const n=t.indexOf(e);return[t.substring(0,n),t.substring(n+1)]},y=t=>{if(t instanceof Uint8Array&&(t=t.buffer.slice(0)),!(t instanceof ArrayBuffer))throw new Error("Expected instance of Buffer or ArrayBuffer");return new DataView(t)},h=(t,e,n)=>new Uint8Array(t.buffer).slice(e,e+n),m=t=>(e,n,r)=>new TextDecoder(t).decode(e.buffer.slice(n,n+r)),u=m("ascii"),b=m(),S=m("utf16be"),L=(t,e)=>{if(t.byteLength<e+27)return;const n=t.getUint8(e+26),r=h(t,e+27,n),a=27+n;if(!r.length)return;const i=a+r.reduce((s,c)=>s+c),o=a+7;return{pageSize:i,packet:y(h(t,e+o,i-o))}},k=t=>{try{const e=t.getUint32(0,!0),n=t.getUint32(4+e,!0),r={},a={tracknumber:"track"};for(let i=0,o=8+e;i<n;i++){const s=t.getUint32(o,!0),c=b(t,o+4,s),[g,T]=U(c,"="),f=g.toLowerCase();r[a[f]||f]=r[f]=d(T),o+=4+s}return r}catch{return}},A=t=>{const e=y(t),n=L(e,0);if(!n)return;const r=L(e,n.pageSize);if(r)return k(r.packet)},M=t=>u(t,t.byteLength-128,3)==="TAG",p=t=>{const e=y(t);try{if(!M(e))return;const n=e.byteLength-128,r=e.getUint8(n+125)===0,a=d(u(e,n+3,30)),i=d(u(e,n+33,30)),o=d(u(e,n+63,30)),s=d(u(e,n+93,4)),c=d(u(e,n+97,r?28:30)),g=r?e.getUint8(n+126):void 0,T=e.getUint8(n+127);return{title:a,artist:i,album:o,year:s,comment:c,track:g,genre:T}}catch{return}},v=(t,e)=>h(t,e,4).reduce((n,r)=>n<<7|r&268435455,0),z=t=>{switch(t){case 1:return(e,n,r)=>e.getUint16(n)===65279?S(e,n,r):m("utf16le")(e,n,r);case 2:return m("utf16be");case 3:return b;case 0:default:return u}},C={TALB:"album",TCOM:"composer",TIT1:"title",TIT2:"title",TPE1:"artist",TRCK:"track",TSSE:"encoder",TDRC:"year",TCON:"genre"},w=(t,e)=>{try{const n=u(t,e,4),r=10+v(t,e+4),a=n[0]==="T"?d(z(t.getUint8(e+9))(t,e+11,r-11)):void 0;return{id:n,size:r,content:a}}catch{return}},B=t=>{const e=y(t);if(u(e,0,3)!=="ID3")return;const n=e.getUint8(5),r=v(e,6),a=!!(n&128),i={},o=a?v(e,10):0;for(let s=10+o;s<10+o+r;){const c=w(e,s);if(!c)break;if(s+=c.size,!c.content)continue;const g=C[c.id]||c.id;if(g==="TXXX"){const[T,f]=U(c.content,"\0");i[T]=f}else i[g]=i[c.id]=c.content}return i};return l.id3v1=p,l.id3v2=B,l.ogg=A,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),l}({});

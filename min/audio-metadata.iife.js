var AudioMetadata=function(g){"use strict";const p=t=>{let e;if(ArrayBuffer.isView(t))e=new DataView(t.buffer,t.byteOffset,t.byteLength);else if(t instanceof ArrayBuffer||t instanceof SharedArrayBuffer)e=new DataView(t);else throw new Error("Expected instance of TypedArray, DataView or ArrayBuffer");return[e,0]},j=t=>{const[e,n]=t;t[1]=n<0?e.byteLength+n:n},u=(t,e)=>{const[n,r]=t;return t[1]+=e,j(t),[n,r]},L=([t,e])=>t.byteLength-e,s=(t,e,n=!1)=>{const[r,c]=u(t,e);return Number(r[{1:"getUint8",2:"getUint16",4:"getUint32",8:"getBigUint64"}[e]](c,n))},I=(t,e)=>{const[n,r]=u(t,e);return n.buffer.slice(r,r+e)},a="ascii",A="utf-8",E="utf-16be",T="utf-16le",o=(t,e,n=A)=>new TextDecoder(n).decode(I(t,e)),S=(t,e)=>new Uint8Array(I(t,e)),y=(t,e)=>p(I(t,e)),h=(t,e=0)=>(...n)=>{const[[r,c],...i]=n;return t([r,c+e],...i)},C=(t,e,n,r)=>{e[n]&&(t[e[n]]=r),t[n]=r},l=t=>t.replace(/\0+$/,""),B=(t,e)=>{const n=t.indexOf(e);return[t.substring(0,n),t.substring(n+1)]},U=t=>{if(L(t)<27)return;const e=(u(t,26),s(t,1)),n=S(t,e);if(!n.length)return;const r=n.reduce((c,i)=>c+i);return u(t,7),{pageSize:r+27+e,packet:y(t,r-7)}},x=t=>{try{const e=s(t,4,!0),n=(u(t,e),s(t,4,!0)),r={},c={tracknumber:"track"};for(let i=0;i<n;i++){const d=s(t,4,!0),m=o(t,d),[f,k]=B(m,"=");C(r,c,f.toLowerCase(),l(k))}return r}catch{return}},K=t=>{const e=p(t);if(!U(e))return;const r=U(e);if(r)return x(r.packet)},G=t=>h(o,-128)(t,3,a)==="TAG",O=t=>h(o,-128)(t,3,a)==="EXT",P=t=>h(o,-128)(t,4,a)==="TAG+",W=t=>{var n,r,c,i;const e=p(t);try{if(!G(e))return;u(e,-128);let d={},m={};O(e)&&(u(e,-125),d={ttl:o(e,30,a),ast:o(e,30,a),alb:o(e,30,a),com:o(e,15,a)},m={subgenre:l(o(e,20,a))}),P(e)&&(u(e,-223),d={ttl:o(e,60,a),ast:o(e,60,a),alb:o(e,60,a)},m={speed:s(e,1),subgenre:l(o(e,30,a)),startTime:l(o(e,6,a)),endTime:l(o(e,6,a))}),u(e,3);const f=h(s,122)(e,1)===0;return{title:l(o(e,30,a)+((n=d.ttl)!=null?n:"")),artist:l(o(e,30,a)+((r=d.ast)!=null?r:"")),album:l(o(e,30,a)+((c=d.alb)!=null?c:"")),year:l(o(e,4,a)),comment:l(o(e,f?28:30,a)+((i=d.com)!=null?i:"")),track:f?s(e,2):void 0,genre:s(e,1),...m}}catch{return}},M=t=>S(t,4).reduce((e,n)=>e<<7|n&127,0),Y=(t,e)=>{var n;return o(t,e-1,(n={0:a,1:h(s,1)(t,2)===65279?E:T,2:E}[s(t,1)])!=null?n:A)},_={TT1:"title",TT2:"title",TIT1:"title",TIT2:"title",TAL:"album",TALB:"album",TP1:"artist",TPE1:"artist",TP2:"albumartist",TPE2:"albumartist",TCM:"composer",TCOM:"composer",TRK:"track",TRCK:"track",TPS:"disc",TPOS:"disc",TYE:"year",TYER:"year",TDRC:"year",TSS:"encoder",TSSE:"encoder",TCO:"genre",TCON:"genre",COM:"comment",COMM:"comment"},$=t=>{try{const e=o(t,4,a),n=M(t);u(t,2);const r=e[0]==="T"?l(Y(t,n)):(u(t,n),void 0);return{id:e,content:r}}catch{return}},D=t=>{const e=p(t);if(o(e,3,a)!=="ID3")return;const n=(u(e,2),s(e,1)),r=M(e),c=!!(n&128),i={},d=c?M(e):0;for(u(e,d);e[1]<10+d+r;){const m=$(e);if(!m)break;if(!!m.content)if(m.id==="TXXX"){const[f,k]=B(m.content,"\0");i[f]=k}else C(i,_,m.id,m.content)}return i},q=t=>{const e=p(t);if(o(e,4,a)!=="fLaC")return;let n=!1,r={};for(;!n;){const c=s(e,1),i=s(e,2)*2**8+s(e,1);n=c>127,(c&127)==4?r={...r,...x(y(e,i))}:u(e,i)}return r},J=t=>"G"+S(t,16).reduce((e,n)=>e+n.toString(16).padStart(2,"0").toUpperCase(),""),v=t=>{try{const e=J(t),n=s(t,8,!0),r=y(t,n-24);return{guid:e,size:n,data:r}}catch{return}},Q=t=>{const e=s(t,2,!0),n=s(t,2,!0),r=s(t,2,!0),c=s(t,2,!0),i=s(t,2,!0);return{title:l(o(t,e,T)),artist:l(o(t,n,T)),copyright:l(o(t,r,T)),comment:l(o(t,c,T)),rating:l(o(t,i,T))}},Z={albumtitle:"album",tracknumber:"track",partofset:"disc",toolname:"encoder",comments:"comment"},V=(t,e,n,r)=>{switch(n=l(n).toLowerCase(),n=n.startsWith("wm/")?n.slice(3):n,e){case 0:C(t,Z,n,l(r));break}},w=t=>{const e={},n=s(t,2,!0);for(let r=0;r<n;r++){const c=s(t,2,!0),i=o(t,c,T),d=s(t,2,!0),m=s(t,2,!0),f=o(t,m,T);V(e,d,i,f)}return e},tt=t=>{var r;u(t,22);let e={},n;for(;n=v(t);){const c={GEACBF8C5AF5B48778467AA8C44FA4CCA:N,G941C23449894D149A1411D134E457054:N};e={...e,...(r=c[n.guid])==null?void 0:r.call(c,n.data)}}return e},N=t=>{const e={},n=s(t,2,!0);for(let r=0;r<n;r++){u(t,4);const c=s(t,2,!0),i=s(t,2,!0),d=s(t,2,!0),m=o(t,c,T),f=o(t,d,T);V(e,i,m,f)}return e},et=t=>{var n;const e=p(t);try{const r=v(e);if(!r||r.guid!=="G3026B2758E66CF11A6D900AA0062CE6C")return;u(r.data,6);let c,i={};for(;c=v(r.data);){const d={G3326B2758E66CF11A6D900AA0062CE6C:Q,G40A4D0D207E3D21197F000A0C95EA850:w,GB503BF5F2EA9CF118EE300C00C205365:tt};i={...i,...(n=d[c.guid])==null?void 0:n.call(d,c.data)}}return i}catch{return}},nt=t=>{try{const e=s(t,4),n=o(t,4,a),r=e===1?s(t,8):e||L(t);return{size:r,type:n,data:y(t,r-(e===1?16:8))}}catch{return}},F=function*(t){let e,n=0;for(;(e=nt(t))&&!(n++>100);)yield e},rt={"\xA9nam":"title","\xA9alb":"album","\xA9ART":"artist",aART:"albumartist","\xA9wrt":"composer","\xA9com":"composer",trkn:"track",disk:"disc","\xA9day":"year","\xA9too":"encoder","\xA9gen":"genre",gnre:"genre","\xA9cmt":"comment"},ot=t=>{const e=[...F(t)].find(n=>n.type==="data");if(e){const n=e.data,r=s(n,4);u(n,4);const c={1:A,2:E,4:A,5:E}[r];return c&&o(n,L(n),c)}},ct=t=>{const e={};for(const{data:n,type:r}of F(t)){const c=ot(n);c&&C(e,rt,r,c)}return e},b=t=>{var n;let e={};for(const{type:r,data:c}of F(t))e={...e,...(n=R[r])==null?void 0:n.call(R,c)};return e},R={moov:b,trak:b,mdia:b,udta:b,meta:t=>b(st(t)),ilst:ct},st=t=>{const e=h(o,4)(t,4,a),n=h(o,16)(t,4,a);return e==="hdlr"&&n==="mdta"||u(t,4),t},at=t=>{const e=p(t),n=b(e);return Object.keys(n).length===0?void 0:n},it=t=>h(o,-32)(t,8,a)==="APETAGEX",ut={"album artist":"albumartist"},dt=t=>{const e=p(t);try{if(G(e)&&u(e,-128),O(e)&&u(e,-128),P(e)&&u(e,-227),!it(e))return;const n=h(s,-20)(e,4,!0),r=h(s,-16)(e,4,!0),c={};u(e,-n);for(let i=0;i<r;i++){const d=s(e,4,!0);u(e,4);let m="";for(;;){const k=o(e,1,a);if(k==="\0")break;m+=k}const f=o(e,d,A);C(c,ut,m.toLowerCase(),f)}return c}catch{return}},H=t=>{try{const e=o(t,4,a),n=s(t,4),r=y(t,n);return n%2&&u(t,1),{id:e,size:n,data:r}}catch{return}},lt=t=>{const e=p(t),n=H(e);if(!n||n.id!=="FORM")return;const r=o(n.data,4,a);if(r!=="AIFF"&&r!=="AIFC")return;let c;for(;c=H(n.data);)if(c.id==="ID3 ")return D(c.data[0])},z=t=>{try{const e=o(t,4,a),n=s(t,4,!0),r=y(t,n);return n%2&&u(t,1),{id:e,size:n,data:r}}catch{return}},mt={INAM:"title",IPRD:"album",IART:"artist",IMUS:"composer",IPRT:"track",ITRK:"track",IFRM:"totaltracks",ISFT:"encoder",IGNR:"genre",ICMT:"comment"},ft=t=>{const e={};let n;for(;n=z(t);)C(e,mt,n.id,l(o(n.data,n.size,A)));return e},X=t=>{let e,n={};for(;e=z(t);)switch(e.id){case"id3 ":n={...n,...D(e.data[0])};break;case"LIST":o(e.data,4,a)==="INFO"?n={...n,...ft(e.data)}:n={...n,...X(e.data)};break}return n},gt=t=>{const e=p(t),n=z(e);if(!(!n||n.id!=="RIFF")&&o(n.data,4,a)==="WAVE")return X(n.data)};return g.aiff=lt,g.apev2=dt,g.flac=q,g.id3v1=W,g.id3v2=D,g.mp4=at,g.ogg=K,g.wav=gt,g.wma=et,Object.defineProperties(g,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),g}({});
